<html>
<head><meta charset="utf-8"><title>✔ precompilation directives cause allocations · helpdesk (published) · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/index.html">helpdesk (published)</a></h2>
<h3>Topic: <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.E2.9C.94.20precompilation.20directives.20cause.20allocations.html">✔ precompilation directives cause allocations</a></h3>

<hr>

<base href="https://julialang.zulipchat.com">

<head><link href="https://juliacommunity.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="386425615"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%E2%9C%94%20precompilation%20directives%20cause%20allocations/near/386425615" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Leandro Martínez <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.E2.9C.94.20precompilation.20directives.20cause.20allocations.html#386425615">(Aug 21 2023 at 15:47)</a>:</h4>
<p>I just added precompilation directives (using PrecompileTools) to a package, and in Julia 1.6 a bunch of tests started failing because, <strong>with the precompilation directives</strong> a series of functions start allocating, while without them the functions do not allocate.</p>
<p>I can reproduce the problem exactly: remove the precompilation directives, the tests pass (the functions do not allocate). Add the precompilation directives, the functions start allocating and the tests fail.</p>
<p>That happens in 1.6 but not 1.10. In 1.10 I have no such issues.</p>
<p>So, I have two questions: </p>
<p>1) Is this something known? I find hard to even start debugging that. <br>
2) How can precompilation affect the behavior of a function?</p>



<a name="386427308"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%E2%9C%94%20precompilation%20directives%20cause%20allocations/near/386427308" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Leandro Martínez <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.E2.9C.94.20precompilation.20directives.20cause.20allocations.html#386427308">(Aug 21 2023 at 15:57)</a>:</h4>
<p>(currently just worked around that by only precompiling if version &gt; 1.9, but still the observation is strange)</p>



<a name="386436017"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%E2%9C%94%20precompilation%20directives%20cause%20allocations/near/386436017" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Leandro Martínez <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.E2.9C.94.20precompilation.20directives.20cause.20allocations.html#386436017">(Aug 21 2023 at 16:48)</a>:</h4>
<p>Followup: <a href="https://discourse.julialang.org/t/precompiletools-precompilation-causing-allocations-in-julia-1-6-7/103039/2?u=lmiq">https://discourse.julialang.org/t/precompiletools-precompilation-causing-allocations-in-julia-1-6-7/103039/2?u=lmiq</a></p>



<a name="386457797"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%E2%9C%94%20precompilation%20directives%20cause%20allocations/near/386457797" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Gunnar Farnebäck <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.E2.9C.94.20precompilation.20directives.20cause.20allocations.html#386457797">(Aug 21 2023 at 19:14)</a>:</h4>
<p>It's certainly known. See e.g. <a href="https://github.com/JuliaLang/julia/issues/35972">https://github.com/JuliaLang/julia/issues/35972</a>.</p>



<a name="386461206"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%E2%9C%94%20precompilation%20directives%20cause%20allocations/near/386461206" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Notification Bot <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.E2.9C.94.20precompilation.20directives.20cause.20allocations.html#386461206">(Aug 21 2023 at 19:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="455681">Leandro Martínez</span> has marked this topic as resolved.</p>



<hr><p>Last updated: Nov 01 2025 at 04:39 UTC</p>
</html>