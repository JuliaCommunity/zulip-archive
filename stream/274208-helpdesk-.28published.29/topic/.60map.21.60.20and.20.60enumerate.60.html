<html>
<head><meta charset="utf-8"><title>`map!` and `enumerate` · helpdesk (published) · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/index.html">helpdesk (published)</a></h2>
<h3>Topic: <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60map.21.60.20and.20.60enumerate.60.html">`map!` and `enumerate`</a></h3>

<hr>

<base href="https://julialang.zulipchat.com">

<head><link href="https://juliacommunity.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="381343640"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60map%21%60%20and%20%60enumerate%60/near/381343640" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Alec <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60map.21.60.20and.20.60enumerate.60.html#381343640">(Aug 03 2023 at 03:33)</a>:</h4>
<p>Is it expected that the last item errors?</p>
<div class="codehilite" data-code-language="Julia"><pre><span></span><code><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>

<span class="n">map</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">enumerate</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]));</span><span class="w">       </span><span class="c"># this works</span>
<span class="n">map!</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]);</span><span class="w">                        </span><span class="c"># this works</span>
<span class="n">map!</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)])</span><span class="w">      </span><span class="c"># this works</span>
<span class="n">map!</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="n">enumerate</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]));</span><span class="w">    </span><span class="c"># method error</span>
</code></pre></div>
<p>I also tried <code>(i,x) -&gt; i + x*2</code> with the last one, but that didn't work either. <code>collect</code>ing the enumeration first does work.</p>



<a name="381483205"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60map%21%60%20and%20%60enumerate%60/near/381483205" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakob Nybo Nissen <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60map.21.60.20and.20.60enumerate.60.html#381483205">(Aug 03 2023 at 13:27)</a>:</h4>
<p>It looks like weirdly, <code>map!</code> is not defined for arbitrary iterables.<br>
Anyway, IMO, people should default to lazy mapping in most cases: <code>Iterators.map(x -&gt; x[1] + x[2] * 2, enumerate(a))</code> works just fine</p>



<a name="381557757"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60map%21%60%20and%20%60enumerate%60/near/381557757" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60map.21.60.20and.20.60enumerate.60.html#381557757">(Aug 03 2023 at 17:08)</a>:</h4>
<p>I think that, in the general case, it's not clear how to do assignment on arbitrary iterables, which is probably why <code>map!</code> is not defined for them.  For example, trying to <code>map!</code> from a tuple into a matrix is ambiguous unless you assume some convention for indexing the matrix by <code>1:n</code>.  Probably fine in this case since Julia already has an integer indexing convention for matrices, but it may not generalize well.</p>



<a name="381568247"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60map%21%60%20and%20%60enumerate%60/near/381568247" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Chen <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60map.21.60.20and.20.60enumerate.60.html#381568247">(Aug 03 2023 at 17:46)</a>:</h4>
<p>In my mind fewer functions should be defined for general iterables because some of them make rather large and often incorrect assumptions about their inputs. In that light I agree</p>



<a name="381568620"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60map%21%60%20and%20%60enumerate%60/near/381568620" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Chen <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60map.21.60.20and.20.60enumerate.60.html#381568620">(Aug 03 2023 at 17:48)</a>:</h4>
<p>But in this particular case, it should be known how to do assignment on the destination since it's an Array?</p>



<a name="381568939"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60map%21%60%20and%20%60enumerate%60/near/381568939" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Chen <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60map.21.60.20and.20.60enumerate.60.html#381568939">(Aug 03 2023 at 17:49)</a>:</h4>
<p>A method which takes as source an arbitrary iterable and throws if it doesn't have a known length (which the return type of <code>enumerate</code> does) seems reasonable</p>



<a name="381569812"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60map%21%60%20and%20%60enumerate%60/near/381569812" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60map.21.60.20and.20.60enumerate.60.html#381569812">(Aug 03 2023 at 17:53)</a>:</h4>
<p>You could always assume an implicit mapping by iteration order, but, <code>map</code> is array-aware in a way I'm not entirely sure I understand, for example</p>
<div class="codehilite" data-code-language="Julia"><pre><span></span><code><span class="n">In</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">:</span><span class="w"> </span><span class="n">map</span><span class="p">(</span><span class="n">identity</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">:</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="o">:</span><span class="mi">4</span><span class="p">)</span><span class="o">'</span><span class="p">)</span>
<span class="mi">3</span><span class="o">×</span><span class="mi">4</span><span class="w"> </span><span class="kt">Matrix</span><span class="p">{</span><span class="kt">Int64</span><span class="p">}</span><span class="o">:</span>
<span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="mi">2</span><span class="w">  </span><span class="mi">3</span><span class="w">   </span><span class="mi">4</span>
<span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="mi">4</span><span class="w">  </span><span class="mi">6</span><span class="w">   </span><span class="mi">8</span>
<span class="w"> </span><span class="mi">3</span><span class="w">  </span><span class="mi">6</span><span class="w">  </span><span class="mi">9</span><span class="w">  </span><span class="mi">12</span>
</code></pre></div>
<p>If <code>map!</code> is respecting the array shape of it's arguments, it would be weird if it let you combine them with iterators that dont' have a shape (or have a merely implicit flat shape).</p>



<a name="381571502"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60map%21%60%20and%20%60enumerate%60/near/381571502" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Chen <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60map.21.60.20and.20.60enumerate.60.html#381571502">(Aug 03 2023 at 18:00)</a>:</h4>
<p><code>map</code> is a whole different mess and a can on worms I'd rather not open</p>



<a name="381572407"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60map%21%60%20and%20%60enumerate%60/near/381572407" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Chen <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60map.21.60.20and.20.60enumerate.60.html#381572407">(Aug 03 2023 at 18:03)</a>:</h4>
<p>For <code>map!</code>, I think Base has all the right traits to check that the source iterable has the same size/shape as the destination array before proceeding</p>



<a name="381575468"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60map%21%60%20and%20%60enumerate%60/near/381575468" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> jar <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60map.21.60.20and.20.60enumerate.60.html#381575468">(Aug 03 2023 at 18:14)</a>:</h4>
<p><span class="user-mention" data-user-id="278065">@Brian Chen</span> You  mean in the special case of <code>Iterators.Enumerate{UnitRange{Int64}}</code> or for more general iterators with potentially unknown size?</p>



<a name="381576051"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60map%21%60%20and%20%60enumerate%60/near/381576051" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Brian Chen <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60map.21.60.20and.20.60enumerate.60.html#381576051">(Aug 03 2023 at 18:16)</a>:</h4>
<p>They'd need to have a known size since Arrays have a known size. Enumerating a range or an array happens to fit that criteria, yes</p>



<hr><p>Last updated: Mar 02 2026 at 05:32 UTC</p>
</html>