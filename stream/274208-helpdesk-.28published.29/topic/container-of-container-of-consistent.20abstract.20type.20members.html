<html>
<head><meta charset="utf-8"><title>container-of-container-of-consistent abstract type members · helpdesk (published) · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/index.html">helpdesk (published)</a></h2>
<h3>Topic: <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/container-of-container-of-consistent.20abstract.20type.20members.html">container-of-container-of-consistent abstract type members</a></h3>

<hr>

<base href="https://julialang.zulipchat.com">

<head><link href="https://juliacommunity.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="310903399"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/container-of-container-of-consistent%20abstract%20type%20members/near/310903399" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eugene Shvarts <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/container-of-container-of-consistent.20abstract.20type.20members.html#310903399">(Nov 18 2022 at 19:15)</a>:</h4>
<p>Suppose I have an abstract type A, and a handful of concrete types B&lt;:A , C&lt;:A, etc.. What would be the appropriate way to specify a type Vector{ Union{ Vector{B}, Vector{C}, ...} } ? Vector{Vector{A}}, Vector{Vector{&lt;:A}}, and Vector{&lt;:Vector{A}} all allow the inner containers to take varied input (e.g., [B(), C()]), but I want to exclude these at minimum for performance reasons, and so only allow a situation like [ [B(), B()], [C(), C()] ]</p>



<a name="310904259"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/container-of-container-of-consistent%20abstract%20type%20members/near/310904259" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Syx Pek <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/container-of-container-of-consistent.20abstract.20type.20members.html#310904259">(Nov 18 2022 at 19:20)</a>:</h4>
<div class="codehilite" data-code-language="Julia"><pre><span></span><code><span class="n">julia</span><span class="o">&gt;</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Union</span><span class="p">{</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Int</span><span class="p">},</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">}}}()</span><span class="w"></span>
<span class="kt">Union</span><span class="p">{</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">},</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Int64</span><span class="p">}}[]</span><span class="w"></span>

<span class="n">julia</span><span class="o">&gt;</span><span class="w"> </span><span class="n">push!</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="mi">1</span><span class="o">-</span><span class="n">element</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Union</span><span class="p">{</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">},</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Int64</span><span class="p">}}}</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"></span>

<span class="n">julia</span><span class="o">&gt;</span><span class="w"> </span><span class="n">push!</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">])</span><span class="w"></span>
<span class="mi">2</span><span class="o">-</span><span class="n">element</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Union</span><span class="p">{</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Float64</span><span class="p">},</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Int64</span><span class="p">}}}</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="w"> </span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">]</span><span class="w"></span>

<span class="n">julia</span><span class="o">&gt;</span><span class="w"> </span><span class="n">push!</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="kt">Union</span><span class="p">{</span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="kt">Float64</span><span class="p">}[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="w"></span>
<span class="n">ERROR</span><span class="o">:</span><span class="w"> </span><span class="kt">MethodError</span><span class="o">:</span><span class="w">  </span><span class="o">...</span><span class="w"></span>
</code></pre></div>



<a name="310904688"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/container-of-container-of-consistent%20abstract%20type%20members/near/310904688" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eugene Shvarts <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/container-of-container-of-consistent.20abstract.20type.20members.html#310904688">(Nov 18 2022 at 19:23)</a>:</h4>
<p><span class="user-mention" data-user-id="284969">@Syx Pek</span>  Yes exactly! Is there a way to specify the Union in the language of subtypes, so that I can instantiate more concrete types D&lt;:A, E&lt;:A, etc. and they slot in seamlessly?</p>



<a name="310906412"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/container-of-container-of-consistent%20abstract%20type%20members/near/310906412" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Syx Pek <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/container-of-container-of-consistent.20abstract.20type.20members.html#310906412">(Nov 18 2022 at 19:33)</a>:</h4>
<div class="codehilite" data-code-language="Julia"><pre><span></span><code><span class="n">julia</span><span class="o">&gt;</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">insert_special</span><span class="p">(</span><span class="n">x</span><span class="o">::</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">T</span><span class="p">})</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="kt">T</span><span class="w"> </span><span class="o">&lt;:</span><span class="w"> </span><span class="kt">Number</span><span class="w"></span>
<span class="w">           </span><span class="n">isconcretetype</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">error</span><span class="p">(</span><span class="s">"</span><span class="si">$T</span><span class="s"> is not a concrete type"</span><span class="p">)</span><span class="w"></span>
<span class="w">           </span><span class="n">push!</span><span class="p">(</span><span class="n">get!</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">T</span><span class="p">}[]),</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"></span>
<span class="w">       </span><span class="k">end</span><span class="w"></span>
<span class="n">insert_special</span><span class="w"> </span><span class="p">(</span><span class="n">generic</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">method</span><span class="p">)</span><span class="w"></span>

<span class="n">julia</span><span class="o">&gt;</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Dict</span><span class="p">(</span><span class="kt">Int</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="w"> </span><span class="kt">Float64</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="w"> </span><span class="mf">2.</span><span class="p">,</span><span class="w"> </span><span class="mf">3.</span><span class="p">]])</span><span class="w"></span>
<span class="kt">Dict</span><span class="p">{</span><span class="kt">DataType</span><span class="p">,</span><span class="w"> </span><span class="kt">Vector</span><span class="p">}</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">entries</span><span class="o">:</span><span class="w"></span>
<span class="w">  </span><span class="kt">Float64</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">]]</span><span class="w"></span>
<span class="w">  </span><span class="kt">Int64</span><span class="w">   </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">]]</span><span class="w"></span>

<span class="n">julia</span><span class="o">&gt;</span><span class="w"> </span><span class="n">insert_special</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span><span class="w"></span>
<span class="mi">1</span><span class="o">-</span><span class="n">element</span><span class="w"> </span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Vector</span><span class="p">{</span><span class="kt">Rational</span><span class="p">{</span><span class="kt">Int64</span><span class="p">}}}</span><span class="o">:</span><span class="w"></span>
<span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="o">//</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">//</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>

<span class="n">julia</span><span class="o">&gt;</span><span class="w"> </span><span class="n">insert_special</span><span class="p">(</span><span class="kt">Union</span><span class="p">{</span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="kt">Float64</span><span class="p">}[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">3.</span><span class="p">])</span><span class="w"></span>
<span class="n">ERROR</span><span class="o">:</span><span class="w"> </span><span class="kt">Union</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="w"> </span><span class="kt">Int64</span><span class="p">}</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">concrete</span><span class="w"> </span><span class="n">type</span><span class="w"></span>
<span class="n">Stacktrace</span><span class="o">:</span><span class="w"> </span><span class="o">...</span><span class="w"></span>

<span class="n">julia</span><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">S</span><span class="p">,</span><span class="w"> </span><span class="n">vec</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="c"># Recovering the elements</span><span class="w"></span>
<span class="w">           </span><span class="n">println</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span><span class="w"></span>
<span class="w">       </span><span class="k">end</span><span class="w"></span>
<span class="p">[</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">3.0</span><span class="p">]</span><span class="w"></span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">]</span><span class="w"></span>
<span class="kt">Rational</span><span class="p">{</span><span class="kt">Int64</span><span class="p">}[</span><span class="mi">1</span><span class="o">//</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">//</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span><span class="w"></span>
</code></pre></div>
<p>This works if order doesn't matter. In general, we can allow the struct to be free, but check our vectors during insertion. (One doesn't need a dictionary here)</p>



<a name="310912357"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/container-of-container-of-consistent%20abstract%20type%20members/near/310912357" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Eugene Shvarts <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/container-of-container-of-consistent.20abstract.20type.20members.html#310912357">(Nov 18 2022 at 20:10)</a>:</h4>
<p><span class="user-mention" data-user-id="284969">@Syx Pek</span> awesome, that makes a ton of sense. Thank you!</p>



<hr><p>Last updated: Nov 01 2025 at 04:39 UTC</p>
</html>