<html>
<head><meta charset="utf-8"><title>number of bytes remaining in IO · helpdesk (published) · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/index.html">helpdesk (published)</a></h2>
<h3>Topic: <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html">number of bytes remaining in IO</a></h3>

<hr>

<base href="https://julialang.zulipchat.com">

<head><link href="https://juliacommunity.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="226322167"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322167" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Colin Caine <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322167">(Feb 14 2021 at 20:05)</a>:</h4>
<p>Is there a way of finding out how many bytes remain in an IO stream? I want to be able to work out if  e.g.<code>peek(io, Int)</code> will error without calling it.</p>
<p>I think this can probably only be done by trying to read the file and seeing what happens, then resetting the <code>seek</code> point (which is how <code>peek</code> works), but I thought I'd ask anyway.</p>



<a name="226322269"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322269" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fredrik Ekre <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322269">(Feb 14 2021 at 20:07)</a>:</h4>
<p>You can use <code>bytesavailable</code> maybe?</p>



<a name="226322284"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322284" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Jakob Nybo Nissen <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322284">(Feb 14 2021 at 20:07)</a>:</h4>
<p>Returns zero for me for a nonzero file</p>



<a name="226322800"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322800" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322800">(Feb 14 2021 at 20:17)</a>:</h4>
<p>ohhhh, so interesting that you should mention this... I think this may be a bug</p>



<a name="226322803"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322803" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322803">(Feb 14 2021 at 20:18)</a>:</h4>
<p>are you on 1.6?</p>



<a name="226322841"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322841" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322841">(Feb 14 2021 at 20:18)</a>:</h4>
<p>I saw this also, maybe we should open an issue</p>



<a name="226322842"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322842" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fredrik Ekre <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322842">(Feb 14 2021 at 20:18)</a>:</h4>
<p>Ah, right! I ran into this the other day.</p>



<a name="226322845"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322845" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322845">(Feb 14 2021 at 20:18)</a>:</h4>
<p>ok, we definitely need an issue</p>



<a name="226322850"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322850" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322850">(Feb 14 2021 at 20:18)</a>:</h4>
<p>let me ask on slack first</p>



<a name="226322881"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322881" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fredrik Ekre <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322881">(Feb 14 2021 at 20:20)</a>:</h4>
<p>It might be correct though, since the io stream needs to block before you can read?</p>



<a name="226322930"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322930" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322930">(Feb 14 2021 at 20:20)</a>:</h4>
<p>no, I've seen it give 0 and then immediately <code>readavailable</code> returns something of length <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex"> &gt;0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></p>



<a name="226322938"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322938" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fredrik Ekre <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322938">(Feb 14 2021 at 20:21)</a>:</h4>
<p>Yea but that is because <code>readavailable</code> does block and fill the buffer I think: <a href="https://github.com/JuliaLang/julia/blob/2eeef2e231a55cac770543b6dd673e349adfd797/base/iostream.jl#L381">https://github.com/JuliaLang/julia/blob/2eeef2e231a55cac770543b6dd673e349adfd797/base/iostream.jl#L381</a></p>



<a name="226322965"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226322965" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226322965">(Feb 14 2021 at 20:21)</a>:</h4>
<p>I'm confused, shouldn't <code>readavailable</code> always return the number of bytes indicated before calling it by <code>bytesavailable</code>?</p>



<a name="226323003"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323003" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323003">(Feb 14 2021 at 20:22)</a>:</h4>
<p>that was my understanding of what they're supposed to do</p>



<a name="226323021"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323021" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323021">(Feb 14 2021 at 20:23)</a>:</h4>
<p><code>bytesavailable</code> seems to work on <code>IOBuffer</code> btw, though it may be worth noting that <code>IOBuffer</code> never blocks</p>



<a name="226323030"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323030" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fredrik Ekre <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323030">(Feb 14 2021 at 20:23)</a>:</h4>
<p>Yea I don't know actually.</p>



<a name="226323145"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323145" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323145">(Feb 14 2021 at 20:26)</a>:</h4>
<p>I believe this is something of a MWE</p>
<div class="codehilite" data-code-language="Julia"><pre><span></span><code><span class="n">julia</span><span class="o">&gt;</span> <span class="n">open</span><span class="p">(</span><span class="n">io</span> <span class="o">-&gt;</span> <span class="n">write</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s">"what up"</span><span class="p">),</span> <span class="s">"testfile.txt"</span><span class="p">,</span> <span class="s">"w+"</span><span class="p">)</span>
<span class="mi">7</span>

<span class="n">julia</span><span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="s">"testfile.txt"</span><span class="p">)</span>
<span class="kt">IOStream</span><span class="p">(</span><span class="o">&lt;</span><span class="n">file</span> <span class="n">testfile</span><span class="o">.</span><span class="n">txt</span><span class="o">&gt;</span><span class="p">)</span>

<span class="n">julia</span><span class="o">&gt;</span> <span class="n">bytesavailable</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="mi">0</span>

<span class="n">julia</span><span class="o">&gt;</span> <span class="n">readavailable</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="mi">7</span><span class="o">-</span><span class="n">element</span> <span class="kt">Vector</span><span class="p">{</span><span class="kt">UInt8</span><span class="p">}</span><span class="o">:</span>
 <span class="mh">0x77</span>
 <span class="mh">0x68</span>
 <span class="mh">0x61</span>
 <span class="mh">0x74</span>
 <span class="mh">0x20</span>
 <span class="mh">0x75</span>
 <span class="mh">0x70</span>
</code></pre></div>



<a name="226323154"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323154" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323154">(Feb 14 2021 at 20:26)</a>:</h4>
<p>I believe <code>bytesavailable</code> should return <code>7</code></p>



<a name="226323223"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323223" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kwaku Oskin <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323223">(Feb 14 2021 at 20:28)</a>:</h4>
<p><code># num bytes available without blocking</code></p>



<a name="226323225"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323225" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kwaku Oskin <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323225">(Feb 14 2021 at 20:28)</a>:</h4>
<p>It is written in the source code.</p>



<a name="226323226"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323226" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323226">(Feb 14 2021 at 20:28)</a>:</h4>
<p>Yup, that's what the docs say, and the above does not block, so this looks like a bug</p>



<a name="226323231"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323231" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kwaku Oskin <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323231">(Feb 14 2021 at 20:29)</a>:</h4>
<p>So, it's not the number of bytes from here till the end of the stream.</p>



<a name="226323237"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323237" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kwaku Oskin <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323237">(Feb 14 2021 at 20:29)</a>:</h4>
<p>Mmmm....<br>
You need to block to <code>readavailable</code></p>



<a name="226323252"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323252" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fredrik Ekre <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323252">(Feb 14 2021 at 20:30)</a>:</h4>
<p>I mean, you can not assume that <code>readavailable</code> will give you <code>bytesavailable</code> bytes I think</p>



<a name="226323295"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323295" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323295">(Feb 14 2021 at 20:30)</a>:</h4>
<p>why not?</p>



<a name="226323300"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323300" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fredrik Ekre <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323300">(Feb 14 2021 at 20:30)</a>:</h4>
<p>Because that could have changed between calling <code>bytesavailable</code> and <code>readavailable</code>.</p>



<a name="226323305"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323305" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323305">(Feb 14 2021 at 20:30)</a>:</h4>
<p>well yeah, ok fair enough, but we are seeing it in examples where that is not the case</p>



<a name="226323316"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323316" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kwaku Oskin <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323316">(Feb 14 2021 at 20:31)</a>:</h4>
<p>Hmmm.... I do not quite understand what is intended behaviour, but code itself is rather straightforward.</p>
<div class="codehilite" data-code-language="Julia"><pre><span></span><code><span class="n">bytesavailable</span><span class="p">(</span><span class="n">s</span><span class="o">::</span><span class="kt">IOStream</span><span class="p">)</span> <span class="o">=</span> <span class="nd">@_lock_ios</span> <span class="n">s</span> <span class="k">ccall</span><span class="p">(</span><span class="o">:</span><span class="n">jl_nb_available</span><span class="p">,</span> <span class="kt">Int32</span><span class="p">,</span> <span class="p">(</span><span class="kt">Ptr</span><span class="p">{</span><span class="n">Cvoid</span><span class="p">},),</span> <span class="n">s</span><span class="o">.</span><span class="n">ios</span><span class="p">)</span>

<span class="k">function</span> <span class="n">readavailable</span><span class="p">(</span><span class="n">s</span><span class="o">::</span><span class="kt">IOStream</span><span class="p">)</span>
    <span class="n">lock</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lock</span><span class="p">)</span>
    <span class="n">nb</span> <span class="o">=</span> <span class="k">ccall</span><span class="p">(</span><span class="o">:</span><span class="n">jl_nb_available</span><span class="p">,</span> <span class="kt">Int32</span><span class="p">,</span> <span class="p">(</span><span class="kt">Ptr</span><span class="p">{</span><span class="n">Cvoid</span><span class="p">},),</span> <span class="n">s</span><span class="o">.</span><span class="n">ios</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nb</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">ccall</span><span class="p">(</span><span class="o">:</span><span class="n">ios_fillbuf</span><span class="p">,</span> <span class="kt">Cssize_t</span><span class="p">,</span> <span class="p">(</span><span class="kt">Ptr</span><span class="p">{</span><span class="n">Cvoid</span><span class="p">},),</span> <span class="n">s</span><span class="o">.</span><span class="n">ios</span><span class="p">)</span>
        <span class="n">nb</span> <span class="o">=</span> <span class="k">ccall</span><span class="p">(</span><span class="o">:</span><span class="n">jl_nb_available</span><span class="p">,</span> <span class="kt">Int32</span><span class="p">,</span> <span class="p">(</span><span class="kt">Ptr</span><span class="p">{</span><span class="n">Cvoid</span><span class="p">},),</span> <span class="n">s</span><span class="o">.</span><span class="n">ios</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="n">a</span> <span class="o">=</span> <span class="kt">Vector</span><span class="p">{</span><span class="kt">UInt8</span><span class="p">}(</span><span class="n">undef</span><span class="p">,</span> <span class="n">nb</span><span class="p">)</span>
    <span class="n">nr</span> <span class="o">=</span> <span class="k">ccall</span><span class="p">(</span><span class="o">:</span><span class="n">ios_readall</span><span class="p">,</span> <span class="kt">Csize_t</span><span class="p">,</span> <span class="p">(</span><span class="kt">Ptr</span><span class="p">{</span><span class="n">Cvoid</span><span class="p">},</span> <span class="kt">Ptr</span><span class="p">{</span><span class="n">Cvoid</span><span class="p">},</span> <span class="kt">Csize_t</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">nb</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nr</span> <span class="o">!=</span> <span class="n">nb</span>
        <span class="n">unlock</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lock</span><span class="p">)</span>
        <span class="n">throw</span><span class="p">(</span><span class="kt">EOFError</span><span class="p">())</span>
    <span class="k">end</span>
    <span class="n">unlock</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">lock</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span>
<span class="k">end</span>
</code></pre></div>



<a name="226323317"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323317" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fredrik Ekre <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323317">(Feb 14 2021 at 20:31)</a>:</h4>
<p>What example? In your example you get mroe bytes than <code>bytesavailable</code> says so I think that is fine.</p>



<a name="226323391"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323391" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kwaku Oskin <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323391">(Feb 14 2021 at 20:33)</a>:</h4>
<p>So to <code>readavailable</code>it verify number of available bytes and if it is zero it fills the buffer and update this number.</p>



<a name="226323407"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323407" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kwaku Oskin <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323407">(Feb 14 2021 at 20:33)</a>:</h4>
<p>So, I think, correct meaning of <code>bytesavailable</code> is not the number of bytes available in <code>iostream</code>, but number of bytes available in the intermediate buffer.</p>



<a name="226323451"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323451" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kwaku Oskin <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323451">(Feb 14 2021 at 20:34)</a>:</h4>
<p>Purely technical thing.</p>



<a name="226323459"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323459" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323459">(Feb 14 2021 at 20:34)</a>:</h4>
<p>Yeah, I noticed that it's a direct ccall, kind of makes me suspect it's an intended thing, but I don't know why</p>



<a name="226323468"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323468" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323468">(Feb 14 2021 at 20:35)</a>:</h4>
<p>well, regardless, I find it all very confusing</p>



<a name="226323472"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323472" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323472">(Feb 14 2021 at 20:35)</a>:</h4>
<p>"number of bytes available before blocking" sounds very straightforward, and it's clearly not giving me that</p>



<a name="226323512"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323512" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kwaku Oskin <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323512">(Feb 14 2021 at 20:36)</a>:</h4>
<p>It depends on how you define <code>blocking</code></p>



<a name="226323519"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323519" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Kwaku Oskin <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323519">(Feb 14 2021 at 20:36)</a>:</h4>
<p>For me, <code>blocking</code> means that you temporarily "own" file handler to read next chunk of data from the file.</p>



<a name="226323522"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323522" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323522">(Feb 14 2021 at 20:37)</a>:</h4>
<p>well I did not do an <code>@async</code> or <code>@spawn</code> and it's not stopping the execution, so that seems to me like it's not blocking</p>



<a name="226323528"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323528" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fredrik Ekre <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323528">(Feb 14 2021 at 20:37)</a>:</h4>
<p>Yea I am pretty sure that is what is meant.</p>



<a name="226323843"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323843" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fredrik Ekre <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323843">(Feb 14 2021 at 20:45)</a>:</h4>
<p>What are you using it for? I thought I would have use for it the other day but in the end I only use <code>read</code> and <code>write</code> with async tasks.</p>



<a name="226323848"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323848" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Fredrik Ekre <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323848">(Feb 14 2021 at 20:45)</a>:</h4>
<p><a href="https://github.com/JuliaLang/julia/issues/24526">https://github.com/JuliaLang/julia/issues/24526</a> has some review of this btw</p>



<a name="226323860"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323860" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323860">(Feb 14 2021 at 20:46)</a>:</h4>
<p>Ok, I just had a conversation on slack, I think our problem is just that we are conflating different types of blocking</p>



<a name="226323908"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226323908" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Expanding Man <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226323908">(Feb 14 2021 at 20:46)</a>:</h4>
<p>readavailable seems to normally only block on relatively fast stuff</p>



<a name="226326499"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/number%20of%20bytes%20remaining%20in%20IO/near/226326499" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Colin Caine <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/number.20of.20bytes.20remaining.20in.20IO.html#226326499">(Feb 14 2021 at 21:47)</a>:</h4>
<p>I feel like <code>bytesavailable</code> isn't what I want. I want to know if there are at least N bytes remaining in the file or stream, but I don't care how many are currently buffered. When N = 1, this is equivalent to <code>eof(io)</code>, but I want to be able to pick other Ns.</p>



<hr><p>Last updated: Nov 01 2025 at 04:39 UTC</p>
</html>