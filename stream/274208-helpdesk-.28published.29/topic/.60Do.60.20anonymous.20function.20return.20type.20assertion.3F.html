<html>
<head><meta charset="utf-8"><title>`Do` anonymous function return type assertion? · helpdesk (published) · Zulip Chat Archive</title></head>
<h2>Stream: <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/index.html">helpdesk (published)</a></h2>
<h3>Topic: <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html">`Do` anonymous function return type assertion?</a></h3>

<hr>

<base href="https://julialang.zulipchat.com">

<head><link href="https://juliacommunity.github.io/zulip-archive/style.css" rel="stylesheet"></head>

<a name="463114738"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60Do%60%20anonymous%20function%20return%20type%20assertion%3F/near/463114738" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Purdy <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html#463114738">(Aug 18 2024 at 06:53)</a>:</h4>
<p>Is there a way to assert the return type of a function generated by a do statement?  Something like</p>
<p>J = [1,2,3];<br>
foreach(J) do (x::Int)::Int x + 1 end;</p>
<p>Was trying to write a Julia parser for fun, realized it seemed like type assertions here don't seem to work.  Type assertions for the arguments, and default arguments seem to work in a do, though.</p>



<a name="463177220"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60Do%60%20anonymous%20function%20return%20type%20assertion%3F/near/463177220" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mason Protter <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html#463177220">(Aug 18 2024 at 14:01)</a>:</h4>
<p>Nope, this isn't supported.</p>



<a name="463177374"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60Do%60%20anonymous%20function%20return%20type%20assertion%3F/near/463177374" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mason Protter <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html#463177374">(Aug 18 2024 at 14:02)</a>:</h4>
<p>you could write</p>
<div class="codehilite" data-code-language="Julia"><pre><span></span><code><span class="n">foreach</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="n">x</span><span class="o">::</span><span class="kt">Int</span>
<span class="w">    </span><span class="n">y</span><span class="o">::</span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="n">y</span>
<span class="k">end</span>
</code></pre></div>
<p>and that'll be equivalent, but because of the awful semantics of assignment returning the <del>lhs instead of the rhs</del> rhs instead of the lhs, the above pattern isn't really a good idea because people might end up shortening it to</p>
<div class="codehilite" data-code-language="Julia"><pre><span></span><code><span class="n">foreach</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="n">x</span><span class="o">::</span><span class="kt">Int</span>
<span class="w">    </span><span class="n">y</span><span class="o">::</span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="k">end</span>
</code></pre></div>
<p>which doesn't actually do the same thing.</p>



<a name="463191769"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60Do%60%20anonymous%20function%20return%20type%20assertion%3F/near/463191769" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Purdy <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html#463191769">(Aug 18 2024 at 15:35)</a>:</h4>
<p>Ah ok, thank you.  I'm assuming there's no plans to support it, either?</p>



<a name="463192060"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60Do%60%20anonymous%20function%20return%20type%20assertion%3F/near/463192060" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mason Protter <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html#463192060">(Aug 18 2024 at 15:39)</a>:</h4>
<p>Nope. Method return type assertions are mostly considered an afterthought anyways. Nobody really uses or recommends them.</p>



<a name="463193694"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60Do%60%20anonymous%20function%20return%20type%20assertion%3F/near/463193694" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Purdy <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html#463193694">(Aug 18 2024 at 15:48)</a>:</h4>
<p>Ok, gotchya.</p>



<a name="463194245"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60Do%60%20anonymous%20function%20return%20type%20assertion%3F/near/463194245" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mason Protter <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html#463194245">(Aug 18 2024 at 15:50)</a>:</h4>
<p>It's unclear what the syntax for it could even be.</p>



<a name="463194473"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60Do%60%20anonymous%20function%20return%20type%20assertion%3F/near/463194473" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mason Protter <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html#463194473">(Aug 18 2024 at 15:51)</a>:</h4>
<p>like, the syntax you proposed,</p>
<div class="codehilite" data-code-language="Julia"><pre><span></span><code><span class="n">foreach</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="o">::</span><span class="kt">Int</span><span class="p">)</span><span class="o">::</span><span class="kt">Int</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="k">end</span>
</code></pre></div>
<p>wouldn't work for multi-argument functions, because then the parentheses would mean argument-destructuring</p>



<a name="463195369"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60Do%60%20anonymous%20function%20return%20type%20assertion%3F/near/463195369" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Thomas Purdy <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html#463195369">(Aug 18 2024 at 15:55)</a>:</h4>
<p>I guess you could do something terrible, like have it to the right of 'do'.  Having it at the 'end' wouldn't work as it'd be for the overall statement, though that'd seem more natural.</p>
<p>I personally like shoving type assertions everywhere, though I don't really use do statements enough for it to be relevant.</p>



<a name="463195648"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60Do%60%20anonymous%20function%20return%20type%20assertion%3F/near/463195648" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mosè Giordano <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html#463195648">(Aug 18 2024 at 15:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="269150">Mason Protter</span> <a href="#narrow/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F/near/463177374">said</a>:</p>
<blockquote>
<p>but because of the awful semantics of assignment returning the lhs instead of the rhs</p>
</blockquote>
<p>Isn't it the opposite?</p>



<a name="463195706"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60Do%60%20anonymous%20function%20return%20type%20assertion%3F/near/463195706" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mason Protter <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html#463195706">(Aug 18 2024 at 15:56)</a>:</h4>
<p>whoops, yeah I meant to write the opposite</p>



<a name="463195898"></a>
<h4><a href="https://julialang.zulipchat.com#narrow/stream/274208-helpdesk%20%28published%29/topic/%60Do%60%20anonymous%20function%20return%20type%20assertion%3F/near/463195898" class="zl"><img src="https://juliacommunity.github.io/zulip-archive/assets/img/zulip.svg" alt="view this post on Zulip" style="width:20px;height:20px;"></a> Mason Protter <a href="https://juliacommunity.github.io/zulip-archive/stream/274208-helpdesk-.28published.29/topic/.60Do.60.20anonymous.20function.20return.20type.20assertion.3F.html#463195898">(Aug 18 2024 at 15:57)</a>:</h4>
<p>returning the lhs is what would make that do the thing that makes sense</p>



<hr><p>Last updated: Nov 01 2025 at 04:39 UTC</p>
</html>