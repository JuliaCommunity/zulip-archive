[
    {
        "content": "<p>I'm developing a package and every time I launch a new REPL and run this code <code>using Revise;using Pkg; Pkg.activate(\".\");using MyDevPkg</code> it spends about 10 minutes precompiling. This is an unsustainable way of working and very frustrating. To test, I've just let it do all the precompilation, then killed that REPL, started a new one and ran the same lines -&gt; it's precompiling again.</p>\n<p>Is there something I'm missing here? I thought precompilation should be handled correctly automatically?<br>\nI'm on Julia v1.10.7, Revise v3.6.4</p>",
        "id": 490582675,
        "sender_full_name": "japhir",
        "timestamp": 1734987554
    },
    {
        "content": "<p>hmm it also appears to happen with registered packages, it had just finished all the precompilation but after it just finished precompiling mine, the <code>using DifferentialEquations</code> call has also started to precompile again (after just having finished it before closing down the REPL). Did I misconfigure something?</p>",
        "id": 490583880,
        "sender_full_name": "japhir",
        "timestamp": 1734988152
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"740636\">japhir</span> <a href=\"#narrow/stream/274208-helpdesk-.28published.29/topic/The.20package.20I'm.20developing.20precompiles.20every.20time/near/490582675\">said</a>:</p>\n<blockquote>\n<p>I thought precompilation should be handled correctly automatically?</p>\n</blockquote>\n<p>That should be the case. Do you see warnings about precompilation being broken (e.g. because of methods overwritten)?</p>",
        "id": 490586794,
        "sender_full_name": "Mosè Giordano",
        "timestamp": 1734989533
    },
    {
        "content": "<p>I now see a lot of warnings that I did not notice earlier, but I'm not sure what has caused these to appear. They are all of the form:</p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"p\">[</span><span class=\"w\"> </span><span class=\"n\">Info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Precompiling</span><span class=\"w\"> </span><span class=\"n\">GLMakie</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">e9467ef8</span><span class=\"o\">-</span><span class=\"n\">e4e7</span><span class=\"o\">-</span><span class=\"mi\">5192</span><span class=\"o\">-</span><span class=\"mi\">8</span><span class=\"n\">a1a</span><span class=\"o\">-</span><span class=\"n\">b1aee30e663a</span><span class=\"p\">]</span>\n<span class=\"n\">┌</span><span class=\"w\"> </span><span class=\"n\">Warning</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">Module</span><span class=\"w\"> </span><span class=\"n\">GeometryBasics</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"w\"> </span><span class=\"n\">ID</span><span class=\"w\"> </span><span class=\"n\">ffffffff</span><span class=\"o\">-</span><span class=\"n\">ffff</span><span class=\"o\">-</span><span class=\"n\">ffff</span><span class=\"o\">-</span><span class=\"mi\">0000</span><span class=\"o\">-</span><span class=\"mf\">1f8</span><span class=\"n\">ad8b3710e</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"nb\">missing</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"n\">the</span><span class=\"w\"> </span><span class=\"n\">cache</span><span class=\"o\">.</span>\n<span class=\"n\">│</span><span class=\"w\"> </span><span class=\"n\">This</span><span class=\"w\"> </span><span class=\"n\">may</span><span class=\"w\"> </span><span class=\"n\">mean</span><span class=\"w\"> </span><span class=\"n\">GeometryBasics</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"n\">c1252a2</span><span class=\"o\">-</span><span class=\"mf\">5f33</span><span class=\"o\">-</span><span class=\"mi\">56</span><span class=\"n\">bf</span><span class=\"o\">-</span><span class=\"mi\">86</span><span class=\"n\">c9</span><span class=\"o\">-</span><span class=\"mf\">59e7332</span><span class=\"n\">b4326</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"w\"> </span><span class=\"n\">not</span><span class=\"w\"> </span><span class=\"n\">support</span><span class=\"w\"> </span><span class=\"n\">precompilation</span><span class=\"w\"> </span><span class=\"n\">but</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">imported</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"w\"> </span><span class=\"n\">a</span><span class=\"w\"> </span><span class=\"k\">module</span><span class=\"w\"> </span><span class=\"n\">that</span><span class=\"w\"> </span><span class=\"n\">does</span><span class=\"o\">.</span>\n<span class=\"n\">└</span><span class=\"w\"> </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Base</span><span class=\"w\"> </span><span class=\"n\">loading</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">2011</span>\n<span class=\"p\">[</span><span class=\"w\"> </span><span class=\"n\">Info</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Skipping</span><span class=\"w\"> </span><span class=\"n\">precompilation</span><span class=\"w\"> </span><span class=\"n\">since</span><span class=\"w\"> </span><span class=\"n\">precompile</span><span class=\"p\">(</span><span class=\"nb\">false</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"w\"> </span><span class=\"n\">Importing</span><span class=\"w\"> </span><span class=\"n\">GLMakie</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">e9467ef8</span><span class=\"o\">-</span><span class=\"n\">e4e7</span><span class=\"o\">-</span><span class=\"mi\">5192</span><span class=\"o\">-</span><span class=\"mi\">8</span><span class=\"n\">a1a</span><span class=\"o\">-</span><span class=\"n\">b1aee30e663a</span><span class=\"p\">]</span><span class=\"o\">.</span>\n</code></pre></div>",
        "id": 490587100,
        "sender_full_name": "japhir",
        "timestamp": 1734989695
    },
    {
        "content": "<p>my startup.jl is very simple:</p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"k\">try</span>\n<span class=\"w\">    </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">Revise</span>\n<span class=\"k\">catch</span><span class=\"w\"> </span><span class=\"n\">e</span>\n<span class=\"w\">    </span><span class=\"nd\">@warn</span><span class=\"w\"> </span><span class=\"s\">\"Error initializing Revise\"</span>\n<span class=\"k\">end</span>\n\n<span class=\"k\">if</span><span class=\"w\"> </span><span class=\"n\">haskey</span><span class=\"p\">(</span><span class=\"nb\">ENV</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s\">\"INSIDE_EMACS\"</span><span class=\"p\">)</span>\n<span class=\"w\">    </span><span class=\"nb\">ENV</span><span class=\"p\">[</span><span class=\"s\">\"JULIA_EDITOR\"</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s\">\"emacsclient\"</span>\n<span class=\"k\">end</span>\n</code></pre></div>\n<p>and I launch the REPL with julia-repl-mode in emacs, with only this option: <code>(setq julia-repl-switches \"--threads 4\")</code></p>",
        "id": 490587345,
        "sender_full_name": "japhir",
        "timestamp": 1734989819
    },
    {
        "content": "<p>Try to delete the precompile cache in your depot <code>compile/v1.10</code></p>",
        "id": 490589078,
        "sender_full_name": "Mosè Giordano",
        "timestamp": 1734990766
    },
    {
        "content": "<p>OK I have deleted everything in the folder <code>~/.julia/compiled/v1.10</code> and re-ran the code that triggers precompilation (the using lines in my script). This works and I don't see any warnings during precompilation.<br>\nHowever, after killing the REPL and restarting, it starts to precompile my dev package as well as some of its dependencies (<code>74 dependencies successfully precompiled in 215 seconds. 641 already precompiled.</code>) again?!<br>\nAny advice would be appreciated! I have installed julia via juliaup on Arch Linux</p>",
        "id": 490622176,
        "sender_full_name": "japhir",
        "timestamp": 1735009355
    }
]