[
    {
        "content": "<p>Hello!</p>\n<p>I'm trying to make use of some remote CPU cores on a machine I can SSH to. <code>idle-maltair.ucc</code> is an SSH alias for a machine running Julia 1.6, just as I am.<br>\n<a href=\"/user_uploads/7178/mI7cjRZmLu24szYzFE-6jCxz/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/7178/mI7cjRZmLu24szYzFE-6jCxz/image.png\" title=\"image.png\"><img src=\"/user_uploads/7178/mI7cjRZmLu24szYzFE-6jCxz/image.png\"></a></div><p>From the documentation, it looks like <code>addprocs([\"idle-maltair.ucc\"]; dir=\"/tmp\", topology=:master_worker, multiplex=true)</code> should work nicely, however it doesn't.<br>\n<a href=\"/user_uploads/7178/0iMBIEFLOsDvXMwRuiNIt026/image.png\">image.png</a></p>\n<div class=\"message_inline_image\"><a href=\"/user_uploads/7178/0iMBIEFLOsDvXMwRuiNIt026/image.png\" title=\"image.png\"><img src=\"/user_uploads/7178/0iMBIEFLOsDvXMwRuiNIt026/image.png\"></a></div><div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"n\">ERROR</span><span class=\"o\">:</span> <span class=\"n\">TaskFailedException</span>\n\n    <span class=\"n\">nested</span> <span class=\"n\">task</span> <span class=\"n\">error</span><span class=\"o\">:</span> <span class=\"n\">IOError</span><span class=\"o\">:</span> <span class=\"n\">connect</span><span class=\"o\">:</span> <span class=\"n\">connection</span> <span class=\"n\">timed</span> <span class=\"n\">out</span> <span class=\"p\">(</span><span class=\"n\">ETIMEDOUT</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>I've tried a bit of googling, but had no luck so far. Any help would be greatly appreciated.</p>",
        "id": 235055460,
        "sender_full_name": "Timothy",
        "timestamp": 1618734248
    },
    {
        "content": "<p>I've seen similar timeouts  when the connection is not open already. I enabled multiplexing directly in my ssh config and made sure to open a connection to the server before I connect via Julia. </p>\n<p><a href=\"https://discourse.julialang.org/t/addprocs-with-ssh-and-a-proxyjump-times-out/26647\">https://discourse.julialang.org/t/addprocs-with-ssh-and-a-proxyjump-times-out/26647</a></p>",
        "id": 235912449,
        "sender_full_name": "Lasse Peters",
        "timestamp": 1619213427
    },
    {
        "content": "<p>I have this problem too. Did you come up with anything <span class=\"user-mention\" data-user-id=\"400021\">@Timothy</span> ?</p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"n\">julia</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">run</span><span class=\"p\">(</span><span class=\"sb\">`ssh </span><span class=\"si\">$addr</span><span class=\"sb\"> -- '/u/local/apps/julia/1.8.1/bin/julia --version '`</span><span class=\"p\">);</span><span class=\"w\"></span>\n<span class=\"n\">julia</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">1.8.1</span><span class=\"w\"></span>\n\n\n<span class=\"n\">julia</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">procs</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">addprocs</span><span class=\"p\">([</span><span class=\"n\">addr</span><span class=\"p\">];</span><span class=\"w\"> </span><span class=\"n\">exename</span><span class=\"o\">=</span><span class=\"s\">\"/u/local/apps/julia/1.8.1/bin/julia\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">dir</span><span class=\"o\">=</span><span class=\"s\">\"/u/home/\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sshflags</span><span class=\"o\">=</span><span class=\"s\">\"-vv\"</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel_input_open_confirmation</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">callback</span><span class=\"w\"> </span><span class=\"n\">start</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">fd</span><span class=\"w\"> </span><span class=\"mi\">3</span><span class=\"w\"> </span><span class=\"n\">setting</span><span class=\"w\"> </span><span class=\"n\">TCP_NODELAY</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">client_session2_setup</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"n\">debug1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Sending</span><span class=\"w\"> </span><span class=\"n\">command</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">sh</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"err\">'</span><span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">u</span><span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"w\"></span>\n<span class=\"n\">exec</span><span class=\"w\"> </span><span class=\"sc\">'\\\\'</span><span class=\"err\">'</span><span class=\"o\">/</span><span class=\"n\">u</span><span class=\"o\">/</span><span class=\"k\">local</span><span class=\"o\">/</span><span class=\"n\">apps</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">bin</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"sc\">'\\\\'</span><span class=\"err\">'</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">worker</span><span class=\"o\">'</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">request</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"w\"> </span><span class=\"n\">confirm</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel_input_open_confirmation</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">callback</span><span class=\"w\"> </span><span class=\"n\">done</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">open</span><span class=\"w\"> </span><span class=\"n\">confirm</span><span class=\"w\"> </span><span class=\"n\">rwindow</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">rmax</span><span class=\"w\"> </span><span class=\"mi\">32768</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rcvd</span><span class=\"w\"> </span><span class=\"n\">adjust</span><span class=\"w\"> </span><span class=\"mi\">2097152</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel_input_status_confirm</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">type</span><span class=\"w\"> </span><span class=\"mi\">99</span><span class=\"w\"> </span><span class=\"n\">id</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"w\"> </span><span class=\"n\">request</span><span class=\"w\"> </span><span class=\"n\">accepted</span><span class=\"w\"> </span><span class=\"n\">on</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">read</span><span class=\"o\">&lt;=</span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">rfd</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"n\">len</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">read</span><span class=\"w\"> </span><span class=\"n\">failed</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">chan_shutdown_read</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">i0</span><span class=\"w\"> </span><span class=\"n\">o0</span><span class=\"w\"> </span><span class=\"n\">sock</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">wfd</span><span class=\"w\"> </span><span class=\"mi\">4</span><span class=\"w\"> </span><span class=\"n\">efd</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">write</span><span class=\"p\">])</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">input</span><span class=\"w\"> </span><span class=\"n\">open</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">drain</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">ibuf</span><span class=\"w\"> </span><span class=\"n\">empty</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">send</span><span class=\"w\"> </span><span class=\"n\">eof</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">input</span><span class=\"w\"> </span><span class=\"n\">drain</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">closed</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rcvd</span><span class=\"w\"> </span><span class=\"n\">eof</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">output</span><span class=\"w\"> </span><span class=\"n\">open</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">drain</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">obuf</span><span class=\"w\"> </span><span class=\"n\">empty</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">chan_shutdown_write</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">i3</span><span class=\"w\"> </span><span class=\"n\">o1</span><span class=\"w\"> </span><span class=\"n\">sock</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"n\">wfd</span><span class=\"w\"> </span><span class=\"mi\">5</span><span class=\"w\"> </span><span class=\"n\">efd</span><span class=\"w\"> </span><span class=\"mi\">6</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">write</span><span class=\"p\">])</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">output</span><span class=\"w\"> </span><span class=\"n\">drain</span><span class=\"w\"> </span><span class=\"o\">-&gt;</span><span class=\"w\"> </span><span class=\"n\">closed</span><span class=\"w\"></span>\n<span class=\"n\">debug1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">client_input_channel_req</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"> </span><span class=\"n\">rtype</span><span class=\"w\"> </span><span class=\"n\">exit</span><span class=\"o\">-</span><span class=\"n\">status</span><span class=\"w\"> </span><span class=\"n\">reply</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">rcvd</span><span class=\"w\"> </span><span class=\"n\">close</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">almost</span><span class=\"w\"> </span><span class=\"n\">dead</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">gc</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">notify</span><span class=\"w\"> </span><span class=\"n\">user</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">gc</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">user</span><span class=\"w\"> </span><span class=\"n\">detached</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">send</span><span class=\"w\"> </span><span class=\"n\">close</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">is</span><span class=\"w\"> </span><span class=\"n\">dead</span><span class=\"w\"></span>\n<span class=\"n\">debug2</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">garbage</span><span class=\"w\"> </span><span class=\"n\">collecting</span><span class=\"w\"></span>\n<span class=\"n\">debug1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">channel</span><span class=\"w\"> </span><span class=\"mi\">0</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">free</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">client</span><span class=\"o\">-</span><span class=\"n\">session</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">nchannels</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"></span>\n<span class=\"n\">Transferred</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">sent</span><span class=\"w\"> </span><span class=\"mi\">3060</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">received</span><span class=\"w\"> </span><span class=\"mi\">3132</span><span class=\"w\"> </span><span class=\"n\">bytes</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"mf\">63.9</span><span class=\"w\"> </span><span class=\"n\">seconds</span><span class=\"w\"></span>\n<span class=\"n\">Bytes</span><span class=\"w\"> </span><span class=\"n\">per</span><span class=\"w\"> </span><span class=\"n\">second</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">sent</span><span class=\"w\"> </span><span class=\"mf\">47.9</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">received</span><span class=\"w\"> </span><span class=\"mf\">49.0</span><span class=\"w\"></span>\n<span class=\"n\">debug1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">Exit</span><span class=\"w\"> </span><span class=\"n\">status</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"></span>\n\n\n<span class=\"n\">ERROR</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">TaskFailedException</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"n\">nested</span><span class=\"w\"> </span><span class=\"n\">task</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IOError</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">connect</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">connection</span><span class=\"w\"> </span><span class=\"n\">timed</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">ETIMEDOUT</span><span class=\"p\">)</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"n\">caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IOError</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">connect</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">connection</span><span class=\"w\"> </span><span class=\"n\">timed</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">ETIMEDOUT</span><span class=\"p\">)</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 315116628,
        "sender_full_name": "jar",
        "timestamp": 1670698603
    },
    {
        "content": "<p>I never had any luck :(</p>",
        "id": 315118152,
        "sender_full_name": "Timothy",
        "timestamp": 1670699609
    },
    {
        "content": "<p>It feels like the exec line has way too many quotes</p>",
        "id": 315121938,
        "sender_full_name": "Mosè Giordano",
        "timestamp": 1670702269
    },
    {
        "content": "<p>Opened <a href=\"https://github.com/JuliaLang/julia/issues/47863\">https://github.com/JuliaLang/julia/issues/47863</a></p>",
        "id": 315123329,
        "sender_full_name": "jar",
        "timestamp": 1670703271
    },
    {
        "content": "<p>If I try to run that command manually on the server</p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"o\">-</span><span class=\"n\">bash</span><span class=\"o\">-</span><span class=\"mf\">4.2</span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">sh</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">-</span><span class=\"n\">c</span><span class=\"w\"> </span><span class=\"err\">'</span><span class=\"n\">cd</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">u</span><span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"w\"></span>\n<span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">exec</span><span class=\"w\"> </span><span class=\"sc\">'\\\\'</span><span class=\"err\">'</span><span class=\"o\">/</span><span class=\"n\">u</span><span class=\"o\">/</span><span class=\"k\">local</span><span class=\"o\">/</span><span class=\"n\">apps</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">bin</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"sc\">'\\\\'</span><span class=\"err\">'</span><span class=\"w\"> </span><span class=\"o\">--</span><span class=\"n\">worker</span><span class=\"o\">'</span><span class=\"w\"></span>\n<span class=\"n\">sh</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">line</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">u</span><span class=\"o\">/</span><span class=\"k\">local</span><span class=\"o\">/</span><span class=\"n\">apps</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">bin</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">\\:</span><span class=\"w\"> </span><span class=\"n\">No</span><span class=\"w\"> </span><span class=\"n\">such</span><span class=\"w\"> </span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"n\">or</span><span class=\"w\"> </span><span class=\"n\">directory</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 315123658,
        "sender_full_name": "jar",
        "timestamp": 1670703535
    },
    {
        "content": "<p>I'm not sure if that's actually what it's doing or that's just some kind of string representation.</p>",
        "id": 315123867,
        "sender_full_name": "jar",
        "timestamp": 1670703710
    },
    {
        "content": "<p>Maybe you need to specify the remote shell? Edit: Nevermind, I see from the last output that it is bash, so default option should work. Edit2: But maybe <code>sh</code> isn't bash?</p>",
        "id": 315125076,
        "sender_full_name": "Fredrik Ekre",
        "timestamp": 1670704616
    },
    {
        "content": "<p>On the server, </p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">realpath</span><span class=\"w\"> </span><span class=\"o\">$</span><span class=\"p\">(</span><span class=\"n\">which</span><span class=\"w\"> </span><span class=\"n\">sh</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">bin</span><span class=\"o\">/</span><span class=\"n\">bash</span><span class=\"w\"></span>\n<span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">sh</span><span class=\"w\"></span>\n<span class=\"n\">sh</span><span class=\"o\">-</span><span class=\"mf\">4.2</span><span class=\"o\">$</span><span class=\"w\"> </span><span class=\"n\">help</span><span class=\"w\"></span>\n<span class=\"n\">GNU</span><span class=\"w\"> </span><span class=\"n\">bash</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">version</span><span class=\"w\"> </span><span class=\"mf\">4.2.46</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">)</span><span class=\"o\">-</span><span class=\"n\">release</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">redhat</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"p\">)</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 315125525,
        "sender_full_name": "jar",
        "timestamp": 1670704968
    },
    {
        "content": "<p>I tried overriding this line <a href=\"https://github.com/JuliaLang/julia/blob/master/stdlib/Distributed/src/managers.jl#L298\">https://github.com/JuliaLang/julia/blob/master/stdlib/Distributed/src/managers.jl#L298</a> to remove one layer of quoting by deleting <code>escape_shell_posixly()</code> so <code>@show remotecmd</code> looks like</p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"n\">remotecmd</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"sb\">`sh -l -c \"cd -- /tmp</span>\n<span class=\"sb\">exec '/u/local/apps/julia/1.8.1/bin/julia' --worker\"`</span><span class=\"w\"></span>\n</code></pre></div>\n<p>but <code>addprocs</code> still times out.</p>",
        "id": 315126142,
        "sender_full_name": "jar",
        "timestamp": 1670705509
    },
    {
        "content": "<p>If I manually run <code>exec '/u/local/apps/julia/1.8.1/bin/julia' --worker</code> on the server it just sits there, which I guess is what it's supposed to do</p>",
        "id": 315126246,
        "sender_full_name": "jar",
        "timestamp": 1670705589
    },
    {
        "content": "<p>I don't really know how to diagnose this</p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"n\">julia</span><span class=\"o\">&gt;</span><span class=\"w\"> </span><span class=\"n\">Distributed</span><span class=\"o\">.</span><span class=\"n\">addprocs_locked</span><span class=\"p\">(</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"n\">Distributed</span><span class=\"o\">.</span><span class=\"n\">SSHManager</span><span class=\"p\">([</span><span class=\"n\">addr</span><span class=\"p\">]),</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"n\">exename</span><span class=\"o\">=</span><span class=\"s\">\"/u/local/apps/julia/1.8.1/bin/julia\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">           </span><span class=\"n\">dir</span><span class=\"o\">=</span><span class=\"s\">\"/tmp\"</span><span class=\"p\">,</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"n\">ERROR</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"kt\">TaskFailedException</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"n\">nested</span><span class=\"w\"> </span><span class=\"n\">task</span><span class=\"w\"> </span><span class=\"n\">error</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IOError</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">connect</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">connection</span><span class=\"w\"> </span><span class=\"n\">timed</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">ETIMEDOUT</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">Stacktrace</span><span class=\"o\">:</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">worker_from_id</span><span class=\"p\">(</span><span class=\"n\">pg</span><span class=\"o\">::</span><span class=\"kt\">Distributed</span><span class=\"o\">.</span><span class=\"n\">ProcessGroup</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">i</span><span class=\"o\">::</span><span class=\"kt\">Int64</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Distributed</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Distributed</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">cluster</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">1092</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">worker_from_id</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Distributed</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">cluster</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">1089</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">inlined</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"c\">#remote_do#170</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Distributed</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">remotecall</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">557</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">inlined</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">remote_do</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Distributed</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">remotecall</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">557</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">inlined</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">kill</span><span class=\"p\">(</span><span class=\"n\">manager</span><span class=\"o\">::</span><span class=\"kt\">Distributed</span><span class=\"o\">.</span><span class=\"n\">SSHManager</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">pid</span><span class=\"o\">::</span><span class=\"kt\">Int64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">config</span><span class=\"o\">::</span><span class=\"kt\">WorkerConfig</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Distributed</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Distributed</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">managers</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">692</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">6</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">create_worker</span><span class=\"p\">(</span><span class=\"n\">manager</span><span class=\"o\">::</span><span class=\"kt\">Distributed</span><span class=\"o\">.</span><span class=\"n\">SSHManager</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">wconfig</span><span class=\"o\">::</span><span class=\"kt\">WorkerConfig</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Distributed</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Distributed</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">cluster</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">603</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">7</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">setup_launched_worker</span><span class=\"p\">(</span><span class=\"n\">manager</span><span class=\"o\">::</span><span class=\"kt\">Distributed</span><span class=\"o\">.</span><span class=\"n\">SSHManager</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">wconfig</span><span class=\"o\">::</span><span class=\"kt\">WorkerConfig</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">launched_q</span><span class=\"o\">::</span><span class=\"kt\">Vector</span><span class=\"p\">{</span><span class=\"kt\">Int64</span><span class=\"p\">})</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Distributed</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Distributed</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">cluster</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">544</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">8</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">::</span><span class=\"kt\">Distributed</span><span class=\"o\">.</span><span class=\"sa\">var</span><span class=\"s\">\"#45#48\"</span><span class=\"p\">{</span><span class=\"kt\">Distributed</span><span class=\"o\">.</span><span class=\"kt\">SSHManager</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">Vector</span><span class=\"p\">{</span><span class=\"kt\">Int64</span><span class=\"p\">},</span><span class=\"w\"> </span><span class=\"kt\">WorkerConfig</span><span class=\"p\">})()</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Distributed</span><span class=\"w\"> </span><span class=\"o\">./</span><span class=\"n\">task</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">484</span><span class=\"w\"></span>\n\n<span class=\"w\">    </span><span class=\"n\">caused</span><span class=\"w\"> </span><span class=\"n\">by</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">IOError</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">connect</span><span class=\"o\">:</span><span class=\"w\"> </span><span class=\"n\">connection</span><span class=\"w\"> </span><span class=\"n\">timed</span><span class=\"w\"> </span><span class=\"n\">out</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"n\">ETIMEDOUT</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">    </span><span class=\"n\">Stacktrace</span><span class=\"o\">:</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">wait_connected</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"o\">::</span><span class=\"kt\">Sockets</span><span class=\"o\">.</span><span class=\"n\">TCPSocket</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Sockets</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Sockets</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">Sockets</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">529</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">connect</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Sockets</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">Sockets</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">564</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">inlined</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">connect_to_worker</span><span class=\"p\">(</span><span class=\"n\">host</span><span class=\"o\">::</span><span class=\"kt\">String</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">port</span><span class=\"o\">::</span><span class=\"kt\">Int64</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Distributed</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Distributed</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">managers</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">651</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">4</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">connect</span><span class=\"p\">(</span><span class=\"n\">manager</span><span class=\"o\">::</span><span class=\"kt\">Distributed</span><span class=\"o\">.</span><span class=\"n\">SSHManager</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">pid</span><span class=\"o\">::</span><span class=\"kt\">Int64</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">config</span><span class=\"o\">::</span><span class=\"kt\">WorkerConfig</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Distributed</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Distributed</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">managers</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">578</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">5</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">create_worker</span><span class=\"p\">(</span><span class=\"n\">manager</span><span class=\"o\">::</span><span class=\"kt\">Distributed</span><span class=\"o\">.</span><span class=\"n\">SSHManager</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">wconfig</span><span class=\"o\">::</span><span class=\"kt\">WorkerConfig</span><span class=\"p\">)</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Distributed</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Distributed</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">cluster</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">599</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">6</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">setup_launched_worker</span><span class=\"p\">(</span><span class=\"n\">manager</span><span class=\"o\">::</span><span class=\"kt\">Distributed</span><span class=\"o\">.</span><span class=\"n\">SSHManager</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">wconfig</span><span class=\"o\">::</span><span class=\"kt\">WorkerConfig</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">launched_q</span><span class=\"o\">::</span><span class=\"kt\">Vector</span><span class=\"p\">{</span><span class=\"kt\">Int64</span><span class=\"p\">})</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Distributed</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Distributed</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">cluster</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">544</span><span class=\"w\"></span>\n<span class=\"w\">     </span><span class=\"p\">[</span><span class=\"mi\">7</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"o\">::</span><span class=\"kt\">Distributed</span><span class=\"o\">.</span><span class=\"sa\">var</span><span class=\"s\">\"#45#48\"</span><span class=\"p\">{</span><span class=\"kt\">Distributed</span><span class=\"o\">.</span><span class=\"kt\">SSHManager</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">Vector</span><span class=\"p\">{</span><span class=\"kt\">Int64</span><span class=\"p\">},</span><span class=\"w\"> </span><span class=\"kt\">WorkerConfig</span><span class=\"p\">})()</span><span class=\"w\"></span>\n<span class=\"w\">       </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Distributed</span><span class=\"w\"> </span><span class=\"o\">./</span><span class=\"n\">task</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">484</span><span class=\"w\"></span>\n<span class=\"n\">Stacktrace</span><span class=\"o\">:</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">sync_end</span><span class=\"p\">(</span><span class=\"n\">c</span><span class=\"o\">::</span><span class=\"kt\">Channel</span><span class=\"p\">{</span><span class=\"kt\">Any</span><span class=\"p\">})</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Base</span><span class=\"w\"> </span><span class=\"o\">./</span><span class=\"n\">task</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">436</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"k\">macro</span><span class=\"w\"> </span><span class=\"n\">expansion</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"o\">./</span><span class=\"n\">task</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">455</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">inlined</span><span class=\"p\">]</span><span class=\"w\"></span>\n<span class=\"w\"> </span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span><span class=\"w\"> </span><span class=\"n\">addprocs_locked</span><span class=\"p\">(</span><span class=\"n\">manager</span><span class=\"o\">::</span><span class=\"kt\">Distributed</span><span class=\"o\">.</span><span class=\"n\">SSHManager</span><span class=\"p\">;</span><span class=\"w\"> </span><span class=\"n\">kwargs</span><span class=\"o\">::</span><span class=\"kt\">Base</span><span class=\"o\">.</span><span class=\"kt\">Pairs</span><span class=\"p\">{</span><span class=\"kt\">Symbol</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">String</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">Tuple</span><span class=\"p\">{</span><span class=\"kt\">Symbol</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">Symbol</span><span class=\"p\">},</span><span class=\"w\"> </span><span class=\"kt\">NamedTuple</span><span class=\"p\">{(</span><span class=\"ss\">:exename</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"ss\">:dir</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"kt\">Tuple</span><span class=\"p\">{</span><span class=\"kt\">String</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"kt\">String</span><span class=\"p\">}}})</span><span class=\"w\"></span>\n<span class=\"w\">   </span><span class=\"err\">@</span><span class=\"w\"> </span><span class=\"n\">Distributed</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"n\">nix</span><span class=\"o\">/</span><span class=\"n\">store</span><span class=\"o\">/</span><span class=\"n\">ca4hhym3f57vpmhgvylvqp86cmz9gbis</span><span class=\"o\">-</span><span class=\"n\">julia</span><span class=\"o\">-</span><span class=\"n\">bin</span><span class=\"o\">-</span><span class=\"mf\">1.8.1</span><span class=\"o\">/</span><span class=\"n\">share</span><span class=\"o\">/</span><span class=\"n\">julia</span><span class=\"o\">/</span><span class=\"n\">stdlib</span><span class=\"o\">/</span><span class=\"n\">v1</span><span class=\"mf\">.8</span><span class=\"o\">/</span><span class=\"n\">Distributed</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">cluster</span><span class=\"o\">.</span><span class=\"n\">jl</span><span class=\"o\">:</span><span class=\"mi\">490</span><span class=\"w\"></span>\n</code></pre></div>",
        "id": 315136344,
        "sender_full_name": "jar",
        "timestamp": 1670713542
    },
    {
        "content": "<p><span class=\"user-mention silent\" data-user-id=\"326776\">jar</span> <a href=\"#narrow/stream/274208-helpdesk-.28published.29/topic/addprocs.20hangs.20over.20ssh/near/315126246\">said</a>:</p>\n<blockquote>\n<p>If I manually run <code>exec '/u/local/apps/julia/1.8.1/bin/julia' --worker</code> on the server it just sits there, which I guess is what it's supposed to do</p>\n</blockquote>\n<p>does the main process see the new worker though?  if I try locally to start a julia session, do <code>using Distributed</code>, then start another process with <code>julia --worker</code>, the latter sits there but the former shows <code>nprocs() = 1</code>.  I don't really know how this stuff is supposed to work, I never used Distributed</p>",
        "id": 315137689,
        "sender_full_name": "Mosè Giordano",
        "timestamp": 1670714639
    },
    {
        "content": "<p><code>nprocs()</code> (basically) just returns <code>length(Distributed.PGRP.workers)</code> so I don't think it could work like that</p>",
        "id": 315138304,
        "sender_full_name": "jar",
        "timestamp": 1670715034
    },
    {
        "content": "<p>shouldn't it increase when you add more workers?</p>",
        "id": 315138369,
        "sender_full_name": "Mosè Giordano",
        "timestamp": 1670715094
    },
    {
        "content": "<p>It increases when you <code>register_worker(worker)</code>, which happens, like, somewhere</p>",
        "id": 315138574,
        "sender_full_name": "jar",
        "timestamp": 1670715243
    },
    {
        "content": "<blockquote>\n<p>If I manually run <code>exec '/u/local/apps/julia/1.8.1/bin/julia' --worker</code> on the server it just sits there, which I guess is what it's supposed to do</p>\n</blockquote>\n<p>If you start <code>julia --worker</code> and then press Enter once more, the worker should reply to stdout with a line like</p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"n\">julia_worker</span><span class=\"o\">:</span><span class=\"mi\">9794</span><span class=\"c\">#192.0.2.23</span><span class=\"w\"></span>\n</code></pre></div>\n<p>which is the TCP port and IPv4 address that the master process now needs to contact to talk to the worker outside SSH. Because SSH is only used for that initial handshake. That IP address must be reachable.</p>",
        "id": 315895014,
        "sender_full_name": "Markus Kuhn",
        "timestamp": 1671044601
    }
]