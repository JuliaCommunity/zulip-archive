[
    {
        "content": "<p>I am trying to use <a href=\"https://github.com/search?q=LIBSVM.jl&amp;type=Repositories\">LIBSVM.jl</a> with an imbalanced dataset.</p>\n<p>Providing weights for each class doesn't seem to affect the result:</p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">CSV</span>\n<span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">DataFrames</span>\n<span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">LIBSVM</span>\n\n<span class=\"n\">df</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">CSV</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">(</span><span class=\"s\">\"svm.csv\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">DataFrame</span><span class=\"p\">)</span>\n\n<span class=\"n\">X</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">df</span><span class=\"o\">.</span><span class=\"n\">x1</span><span class=\"w\"> </span><span class=\"n\">df</span><span class=\"o\">.</span><span class=\"n\">x2</span><span class=\"w\"> </span><span class=\"n\">df</span><span class=\"o\">.</span><span class=\"n\">x3</span><span class=\"p\">]</span><span class=\"o\">'</span>\n<span class=\"n\">y</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">df</span><span class=\"o\">.</span><span class=\"n\">y</span>\n<span class=\"n\">w</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kt\">Dict</span><span class=\"p\">(</span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"o\">=&gt;</span><span class=\"w\"> </span><span class=\"mi\">1</span><span class=\"w\"> </span><span class=\"o\">/</span><span class=\"w\"> </span><span class=\"n\">count</span><span class=\"p\">(</span><span class=\"o\">==</span><span class=\"p\">(</span><span class=\"n\">l</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">l</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">unique</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">))</span>\n<span class=\"n\">svm</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">svmtrain</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">y</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">weights</span><span class=\"o\">=</span><span class=\"n\">w</span><span class=\"p\">)</span>\n\n<span class=\"n\">x1</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">length</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">)</span>\n<span class=\"n\">x2</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">length</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">)</span>\n<span class=\"n\">x3</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">range</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"mf\">0.5</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">length</span><span class=\"o\">=</span><span class=\"mi\">100</span><span class=\"p\">)</span>\n<span class=\"n\">xs</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"p\">[</span><span class=\"n\">collect</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"k\">for</span><span class=\"w\"> </span><span class=\"n\">x</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"n\">Iterators</span><span class=\"o\">.</span><span class=\"n\">product</span><span class=\"p\">(</span><span class=\"n\">x1</span><span class=\"p\">,</span><span class=\"n\">x2</span><span class=\"p\">,</span><span class=\"n\">x3</span><span class=\"p\">)]</span>\n<span class=\"n\">X̂</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">reduce</span><span class=\"p\">(</span><span class=\"n\">hcat</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">xs</span><span class=\"p\">)</span>\n<span class=\"n\">ŷ</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">_</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">svmpredict</span><span class=\"p\">(</span><span class=\"n\">svm</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">X̂</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>Can you reproduce the issue? I've uploaded the dataset in this gist: <a href=\"https://gist.github.com/juliohm/a0c98c0d386d297e2105818652faa076\">https://gist.github.com/juliohm/a0c98c0d386d297e2105818652faa076</a></p>",
        "id": 327626965,
        "sender_full_name": "Júlio Hoffimann",
        "timestamp": 1676316108
    },
    {
        "content": "<p>Cross-posted on Discourse: <a href=\"https://discourse.julialang.org/t/libsvm-jl-with-imbalanced-dataset/94635\">https://discourse.julialang.org/t/libsvm-jl-with-imbalanced-dataset/94635</a></p>",
        "id": 327821338,
        "sender_full_name": "Júlio Hoffimann",
        "timestamp": 1676392743
    }
]