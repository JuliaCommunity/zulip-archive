[
    {
        "content": "<p>With this module in a package:</p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"k\">module</span><span class=\"w\"> </span><span class=\"n\">JetDebug</span>\n\n<span class=\"n\">greet</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">Base</span><span class=\"o\">.</span><span class=\"n\">blah</span><span class=\"p\">()</span>\n\n<span class=\"k\">end</span><span class=\"w\"> </span><span class=\"c\"># module JetDebug</span>\n</code></pre></div>\n<p>JET finds the problem when run in the REPL:</p>\n<div class=\"codehilite\" data-code-language=\"Julia console\"><pre><span></span><code><span class=\"gp\">julia&gt;</span><span class=\"w\"> </span><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">JET</span>\n\n<span class=\"gp\">julia&gt;</span><span class=\"w\"> </span><span class=\"k\">import</span><span class=\"w\"> </span><span class=\"n\">JetDebug</span>\n\n<span class=\"gp\">julia&gt;</span><span class=\"w\"> </span><span class=\"n\">report_package</span><span class=\"p\">(</span><span class=\"n\">JetDebug</span><span class=\"p\">)</span>\n<span class=\"go\">[toplevel-info] virtualized the context of Main (took 0.022 sec)</span>\n<span class=\"go\">[toplevel-info] entered into /home/james/git/scratch/JetDebug/src/JetDebug.jl</span>\n<span class=\"go\">[toplevel-info]  exited from /home/james/git/scratch/JetDebug/src/JetDebug.jl (took 0.142 sec)</span>\n<span class=\"go\">[toplevel-info] analyzing from top-level definitions (1/1)</span>\n<span class=\"go\">[toplevel-info] analyzed 1 top-level definitions (took 2.595 sec)</span>\n<span class=\"go\">[ Info: tracking Base</span>\n<span class=\"go\">═════ 1 possible error found ═════</span>\n<span class=\"go\">┌ greet() @ JetDebug /home/james/git/scratch/JetDebug/src/JetDebug.jl:3</span>\n<span class=\"go\">│┌ getproperty(x::Module, f::Symbol) @ Base ./Base.jl:42</span>\n<span class=\"go\">││ `Base.blah` is not defined: Base.getglobal(x::Module, f::Symbol)</span>\n<span class=\"go\">│└────────────────────</span>\n</code></pre></div>\n<p>But with this in my <code>runtests.jl</code>:</p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">JET</span>\n<span class=\"k\">using</span><span class=\"w\"> </span><span class=\"n\">JetDebug</span>\n\n<span class=\"n\">report_package</span><span class=\"p\">(</span><span class=\"n\">JetDebug</span><span class=\"p\">)</span>\n</code></pre></div>\n<p>It does not find the problem:</p>\n<div class=\"codehilite\" data-code-language=\"Julia console\"><pre><span></span><code><span class=\"go\">Precompiling project for configuration --code-coverage=none --color=yes --check-bounds=yes --warn-overwrite=yes --depwarn=yes --inline=yes --startup-file=no --track-allocation=none...</span>\n<span class=\"go\">  ✓ JetDebug</span>\n<span class=\"go\">  1 dependency successfully precompiled in 1 seconds. 33 already precompiled.</span>\n<span class=\"go\">  1 dependency precompiled but a different version is currently loaded. Restart julia to access the new version</span>\n<span class=\"go\">     Testing Running tests...</span>\n<span class=\"go\">[toplevel-info] virtualized the context of Main (took 0.026 sec)</span>\n<span class=\"go\">[toplevel-info] entered into /home/james/git/scratch/JetDebug/src/JetDebug.jl</span>\n<span class=\"go\">[toplevel-info]  exited from /home/james/git/scratch/JetDebug/src/JetDebug.jl (took 0.164 sec)</span>\n<span class=\"go\">[toplevel-info] analyzing from top-level definitions (1/1)</span>\n<span class=\"go\">[toplevel-info] analyzed 1 top-level definitions (took 3.472 sec)</span>\n<span class=\"go\">     Testing JetDebug tests passed</span>\n</code></pre></div>\n<p>Why is that? <span aria-label=\"thinking\" class=\"emoji emoji-1f914\" role=\"img\" title=\"thinking\">:thinking:</span> I see that when run from the REPL it tracks <code>Base</code>, which might have something to do with it. But I don't know why it wouldn't track base when run in the tests.</p>",
        "id": 449935226,
        "sender_full_name": "James Wrigley",
        "timestamp": 1720459598
    },
    {
        "content": "<p>Ok, it also fails to find this problem when run in the tests:</p>\n<div class=\"codehilite\" data-code-language=\"Julia\"><pre><span></span><code><span class=\"k\">module</span><span class=\"w\"> </span><span class=\"n\">JetDebug</span>\n\n<span class=\"n\">greet</span><span class=\"p\">()</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">blah</span><span class=\"p\">()</span>\n\n<span class=\"k\">end</span><span class=\"w\"> </span><span class=\"c\"># module JetDebug</span>\n</code></pre></div>\n<p>So I guess the <code>Base</code> tracking is a red herring.</p>",
        "id": 449938527,
        "sender_full_name": "James Wrigley",
        "timestamp": 1720460598
    },
    {
        "content": "<p>I think the explanation is that <code>report_package</code> returns a value that is displayed by the REPL, but when you run <br>\n<code>report_package</code> in the tests, this value is not automatically displayed.</p>\n<p>You could inspect the returned value to get something similar to the behaviour in the REPL: <a href=\"https://gitlab.com/stemann/julia-gitlab-ci-templates/-/blob/v1.5.0/templates.gitlab-ci.yaml#L185-192\">https://gitlab.com/stemann/julia-gitlab-ci-templates/-/blob/v1.5.0/templates.gitlab-ci.yaml#L185-192</a></p>",
        "id": 457312554,
        "sender_full_name": "Jesper Stemann Andersen",
        "timestamp": 1723108543
    },
    {
        "content": "<p>Thanks, yes I actually made an issue about and it turns out I was dumb <span aria-label=\"upside down\" class=\"emoji emoji-1f643\" role=\"img\" title=\"upside down\">:upside_down:</span> <a href=\"https://github.com/aviatesk/JET.jl/issues/646\">https://github.com/aviatesk/JET.jl/issues/646</a><br>\n<code>test_package()</code> is the one I need.</p>",
        "id": 457334030,
        "sender_full_name": "James Wrigley",
        "timestamp": 1723113813
    }
]